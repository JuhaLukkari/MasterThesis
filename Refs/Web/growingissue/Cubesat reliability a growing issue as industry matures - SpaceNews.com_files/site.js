(function($,$window,$document,$body,Site){$.extend(Site,{init:function(){Site.foundation();Site.nav.init();Site.flexVideo();Site.eventCategories();Site.searchFilter();Site.searchSeeAll();},load:function(){},zoom:{level:1,measure:function(){Site.zoom.level=(1/(window.innerHeight/$window.height())).toFixed(2);if(Site.zoom.level<1){Site.zoom.level=1;}
return Site.zoom;}},nav:{init:function(){Site.zoom.measure();Site.nav.node=$('#navs');Site.nav.top=Site.nav.node.position().top;Site.nav.mobile=$('#navs-mobile');Site.nav.bodyMarginTop=parseInt($body.css('marginTop'),10);Site.nav.bodyStickyMarginTop=Site.nav.node.height();var html=document.getElementsByTagName('html')[0];if(Modernizr.touch){window.addEventListener('touchend',Site.nav.sticky);}
$window.on('scroll',Site.nav.sticky);$document.on('open.fndtn.offcanvas',function(){html.style.overflow='hidden';$document.on('click',Site.nav.handleOffCanvasClick);});$document.on('close.fndtn.offcanvas',function(){html.style.overflow='auto';});},sticky:function(){var scrollTop=$window.scrollTop();var zoomThreshold=1.05;Site.zoom.measure();switch(true){case Site.zoom.level>zoomThreshold:$body.addClass('zoomed');Site.nav.node.removeClass('sticky');break;case Site.zoom.level<=zoomThreshold&&scrollTop>Site.nav.top:Site.nav.node.addClass('sticky');$body.css('marginTop',Site.nav.bodyStickyMarginTop);$body.removeClass('zoomed');break;case Site.zoom.level<=zoomThreshold&&scrollTop<=Site.nav.top:Site.nav.node.removeClass('sticky');$body.css('marginTop',Site.nav.bodyMarginTop);$body.removeClass('zoomed');break;}},handleOffCanvasClick:function(e){if($(e.target).parents('.left-off-canvas-menu').length===0){$('.left-off-canvas-menu .exit-off-canvas').trigger('click');$document.off('click',Site.nav.handleOffCanvasClick);}}},flexVideo:function(){var iframe=$('p iframe, figure iframe');var wrapper='<div class="flex-video widescreen"/>';iframe.wrap(wrapper);},foundation:function(){$document.foundation({offcanvas:{open_method:'overlap_single',close_on_click:true}});},eventCategories:function(){$('nav.event-categories label').on('click',function(e){e.preventDefault();$(this).toggleClass('open').next().slideToggle(200);});},searchFilter:function(){var $input_filters=$('.SearchFilter input'),$select_filters=$('.SearchFilter select'),$search=$('form.search-form').eq(0);if(!$search.length){return;}
$input_filters.change(function(){var $filter=$(this),$existing_filter=$search.find('input[name="'+ $filter.attr('name')+'"]');if($filter.prop('checked')){if($existing_filter.length){$existing_filter.val($existing_filter.val()+'+'+ $filter.val());}else{$('<input type="hidden" name="'+ $filter.attr('name')+'" />').val($filter.val()).appendTo($search);}}else{if($existing_filter.length){var filter=$existing_filter.val().replace($filter.val(),'').replace(/\+\+/,'+').replace(/(^\+)|(\+$)/,'');if(filter.length){$existing_filter.val(filter);}else{$existing_filter.remove();}}}
$search.submit();});$select_filters.change(function(){var $filter=$(this),$existing_filter=$search.find('input[name="'+ $filter.attr('name')+'"]');if($filter.val().length){if($existing_filter.length){$existing_filter.val($filter.val());}else{$('<input type="hidden" name="'+ $filter.attr('name')+'" />').val($filter.val()).appendTo($search);}}else{if($existing_filter.length){$existing_filter.remove();}}
$search.submit();});},searchSeeAll:function(){var $more=$('.SearchFilter .more a');if(!$more.length){return;}
$more.click(function(e){var $this=$(this);e.preventDefault();$this.parents('ul:first').find('li').show();$this.parent().hide();});}});window.Site=Site;$document.ready(function(){Site.init();});$window.on('load',function(){Site.load();});})(jQuery,jQuery(window),jQuery(document),jQuery(document.body),window.Site||{});